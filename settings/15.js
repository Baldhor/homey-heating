(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{374:function(e,t,a){"use strict";a.d(t,"a",function(){return l});var n=a(373);function l(e,t,a=null){return n.b(this,void 0,void 0,function*(){return yield new Promise((n,l)=>{Homey.api(e,t,a,(e,t)=>{e?l(e):n(t)})})})}},376:function(e,t,a){"use strict";a.d(t,"b",function(){return s}),a.d(t,"a",function(){return r});var n=a(373),l=a(17),c=a(374);const o=e=>n.b(void 0,void 0,void 0,function*(){const t=Object.assign({},e);return t.zones&&0!==t.zones.length||(t.zones=void 0),t.devices&&0!==t.devices.length||(t.devices=void 0),yield Object(c.a)("PUT",`/plans/${e.id}`,t)}),s={fetchPlans:()=>n.b(void 0,void 0,void 0,function*(){const e=yield Object(c.a)("GET","/plans");return Object(l.sortBy)(Object(l.map)(e,e=>(e.zones=e.zones||[],e.devices=e.devices||[],e)),e=>e.name)}),fetchPlanById:e=>n.b(void 0,void 0,void 0,function*(){const t=yield Object(c.a)("GET",`/plans/${e}`);if(null==t)throw new Error(`Plan ${e} not found.`);return t.zones=t.zones||[],t.devices=t.devices||[],t}),fetchSchedule:()=>n.b(void 0,void 0,void 0,function*(){const e=yield Object(c.a)("GET","/schedule");return e.temperatures=Object(l.sortBy)(e.temperatures,[e=>e.device.name]),e}),updatePlan:o,removePlan:e=>n.b(void 0,void 0,void 0,function*(){return yield Object(c.a)("DELETE",`/plans/${e}`)}),togglePlanState:e=>n.b(void 0,void 0,void 0,function*(){return e.enabled=!e.enabled,yield o(e),!0})},r={fetchMode:()=>n.b(void 0,void 0,void 0,function*(){return(yield Object(c.a)("GET","/mode")).mode}),setMode:e=>n.b(void 0,void 0,void 0,function*(){return yield Object(c.a)("PUT","/mode",{mode:e})})}},377:function(e,t,a){"use strict";var n=a(143),l=a.n(n),c=a(19),o=a(144),s=a.n(o),r=a(39),i=a.n(r),u=a(0),d=a.n(u);t.a=Object(c.withStyles)(e=>({appBar:{},grow:{flexGrow:1},buttons:{display:"flex"},toolbar:{alignItems:"center",justifyContent:"space-between"}}))(e=>{const{classes:t}=e,{button:a,title:n,actions:c,subBar:o}=e.children||{button:null,title:null,actions:null,subBar:null};return d.a.createElement(u.Fragment,null,d.a.createElement(l.a,{position:"absolute",color:"primary",className:t.appBar},d.a.createElement(s.a,{className:t.toolbar},e.button||a,d.a.createElement(i.a,{variant:"h6",color:"inherit",noWrap:!0},e.title||n),d.a.createElement("div",{className:t.grow}),null!=c&&d.a.createElement("div",{className:t.buttons},c)),null!=o&&o))})},379:function(e,t,a){"use strict";var n=a(373),l=a(48),c=a(19),o=a(145),s=a.n(o),r=a(382),i=a.n(r),u=a(0),d=a.n(u),b=a(28),m=a(85),p=a(86);function y(e){var{innerRef:t}=e,a=n.d(e,["innerRef"]);return a.to.toString().match(/https/)?d.a.createElement("a",Object.assign({onClick:()=>Homey.openURL(a.to.toString())},a),a.children):d.a.createElement(p.b,Object.assign({},a))}var f=e=>d.a.createElement(l.n,Object.assign({},e,{component:y}),e.children);a.d(t,"a",function(){return h}),a.d(t,"b",function(){return O});const v=e=>({text:{padding:2*e.spacing.unit,paddingBottom:0},version:{padding:2*e.spacing.unit,paddingTop:0},normal:{},selected:{color:e.palette.primary.main},otherButton:{},firstButton:{marginLeft:-12}}),h=e=>{const[t,a]=d.a.useState(!1);return d.a.createElement(d.a.Fragment,null,d.a.createElement(g,{open:t,onClose:()=>{a(!1)}}),d.a.createElement(O,{first:!0,onClick:()=>{a(!0)},icon:d.a.createElement(i.a,null)}))},g=Object(b.e)(Object(c.withStyles)(v)(e=>{const{classes:t}=e,a=[{type:"entry",to:"/",text:Object(m.a)("menu.plans")},{to:"/temperatures",text:Object(m.a)("menu.temperatures")},{to:"/schedules",text:Object(m.a)("menu.schedules")},{to:"/settings",text:Object(m.a)("menu.settings")},{to:"https://homey-heating.mskg.app",text:Object(m.a)("menu.help")}];return d.a.createElement(s.a,{open:e.open,onClose:e.onClose},d.a.createElement(l.v,{className:t.text,variant:"h5",gutterBottom:!0},Object(m.a)("menu.title")),d.a.createElement(l.v,{className:t.version,variant:"body2",color:"textSecondary",gutterBottom:!0},"Version ","1.2.2-rc1"," (","682",")"),d.a.createElement(l.h,null),d.a.createElement(l.m,null,a.map(a=>"Divider"===a.type?d.a.createElement(l.h,null):d.a.createElement(f,{key:a.to,to:a.to,disabled:e.match.url===a.to,button:!0},d.a.createElement(l.q,{primary:a.text,classes:{primary:e.match.url!==a.to?t.normal:t.selected}})))))})),O=Object(c.withStyles)(v)(e=>{const{classes:t,first:a,icon:c}=e,o=n.d(e,["classes","first","icon"]);return d.a.createElement(l.j,Object.assign({className:a?t.firstButton:t.otherButton,color:"inherit"},o),c)})},380:function(e,t,a){"use strict";var n=a(19),l=a(0),c=a.n(l);t.a=Object(n.withStyles)(e=>({root:{webkitOverflowScrolling:"touch",display:"flex",flexFlow:"column",height:"100vh",width:"100vw",backgroundColor:"#fff"},body:{flex:"1 0 100%",margin:0,maxWidth:"100%",overflowY:"scroll"}}))(e=>{const{classes:t}=e,{header:a,body:n,paddingTop:l,paddingBottom:o}=e.children,s=o||"auto";return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:t.root},a,c.a.createElement("div",{className:t.body,style:{paddingTop:l,paddingBottom:s}},n)))})},393:function(e,t,a){"use strict";a.d(t,"a",function(){return s}),a.d(t,"c",function(){return r}),a.d(t,"b",function(){return i}),a.d(t,"d",function(){return u}),a.d(t,"e",function(){return b});var n=a(0),l=a(391),c=a(376),o=a(88);const s=()=>{const e=Object(o.b)(),t=Object(o.c)("loaded"),a=Object(n.useCallback)(()=>e({type:"savePoint"}),[e]),l=Object(n.useCallback)(()=>e({type:"undo"}),[e]),c=Object(n.useCallback)(()=>e({type:"commit"}),[e]);return Object(n.useEffect)(()=>{a()},[t]),{savePoint:a,undo:l,commit:c}},r=()=>{const e=Object(o.b)();return{setName:Object(n.useCallback)(t=>e({type:"setName",name:t.target.value}),[e]),setDescription:Object(n.useCallback)(t=>e({type:"setDescription",description:t.target.value}),[e]),toggleState:Object(n.useCallback)(()=>e({type:"toggleEnabled"}),[e]),toggleZone:Object(n.useCallback)(t=>e({type:"toggleZone",zone:t}),[e]),toggleDevice:Object(n.useCallback)(t=>e({type:"toggleDevice",device:t}),[e])}},i=()=>{const e=Object(o.b)(),[t,a]=Object(n.useState)(!1),l=Object(n.useCallback)((t,n)=>{e({type:"setOverride",mode:t,temperature:n}),a(!0)},[e]),c=Object(n.useCallback)(t=>{e({type:"clearOverride",mode:t}),a(!0)},[e]),s=Object(n.useCallback)((e,t)=>{0===t?c(e):l(e,t)},[e]);return Object(n.useEffect)(()=>{a(!1)},[]),{isDirty:t,setOverride:l,clearOverride:c,updateOverride:s}},u=()=>{const[e,t]=Object(n.useState)(!1),a=Object(o.b)(),l=Object(n.useCallback)(e=>{a({type:"selectDay",day:e})},[a]),c=Object(o.c)("selectedDay"),s=Object(o.c)("setPoint"),r=Object(n.useCallback)((e,n)=>{null!=n&&n.length>0&&(t(!0),a({type:"copyDays",source:e,targets:n}))},[a]),i=Object(n.useCallback)(e=>{t(!0),a({type:"removeSetPoint",index:e})},[a]),u=Object(n.useCallback)(e=>{a({type:"loadSetPoint",setPoint:e})},[a]),d=Object(n.useCallback)(e=>{a({type:"newSetPoint",day:e})},[a]),b=Object(n.useCallback)(e=>{-1===e.index?a({type:"addSetPoint",setPoint:e}):a({type:"updateSetPoint",setPoint:e})},[a]),m=Object(n.useCallback)(e=>a({type:"setStart",start:e}),[a]),p=Object(n.useCallback)(e=>a({type:"setTargetTemperature",temperature:parseFloat(e.target.value)}),[a]);return Object(n.useEffect)(()=>{t(!1)},[]),{setDirty:t,isDirty:e,selectedDay:c,setPoint:s,copyDays:r,removeSetPoint:i,loadSetPoint:u,newSetPoint:d,selectDay:l,saveSetPoint:b,setStart:m,setTargetTemperature:p}};let d=!1;const b=(e,t=!0)=>{const a=Object(o.b)(),s=Object(o.c)("plan"),r=Object(o.c)("loaded"),i=Object(o.c)("dirty");if(!r||!t)if(null!=e&&"new"!==e||d){if(!d)throw c.b.fetchPlanById(e).then(e=>{d=!0,a({type:"loadPlan",plan:e})})}else d=!0,a({type:"loadPlan",plan:{id:l(),enabled:!1,name:"",zones:[],devices:[],schedule:[],overrides:void 0}});return Object(n.useEffect)(()=>()=>{d=!1},[e,t]),{plan:s,isDirty:i,loaded:r}}},403:function(e,t,a){"use strict";a.d(t,"a",function(){return d});var n=a(154),l=a.n(n),c=a(97),o=a.n(c),s=a(90),r=a.n(s),i=a(153),u=a.n(i);const d=e=>{const t=Math.round(100*function(e,t,a,n,l){return Math.floor((l-n)*(e-t)/(a-t)+n)}(Math.min(Math.max(16,e),24),16,24,1,8)+100);return e<=16?o.a[t]:e<=18.5?u.a[t]:e<=20.5?l.a[t]:r.a[t]}},411:function(e,t,a){"use strict";var n=a(152),l=a.n(n),c=a(19),o=a(402),s=a.n(o),r=a(0),i=a.n(r);t.a=Object(c.withStyles)(e=>({fabButton:{zIndex:1,margin:"0 auto",position:"absolute",bottom:2*e.spacing.unit,right:2*e.spacing.unit}}))(e=>{const{classes:t}=e;return i.a.createElement(l.a,{color:"secondary","aria-label":"Add",className:t.fabButton,onClick:()=>e.onClick()},i.a.createElement(s.a,null))})},413:function(e,t,a){"use strict";a.d(t,"a",function(){return v}),a.d(t,"b",function(){return h});var n=a(48),l=a(19),c=a(151),o=a.n(c),s=a(90),r=a.n(s),i=a(423),u=a.n(i),d=a(0),b=a.n(d),m=a(403);const p=a(414),y=e=>({root:{fontSize:"1em",float:"left",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",width:45},avatar:{width:35,height:35,lineHeight:35,position:"relative",overflow:"hidden"},img:{width:35,height:35,zIndex:2,position:"absolute",left:0,bottom:0},fill:{display:"block",width:35,height:33,zIndex:1,position:"absolute",left:0,bottom:1}});function f(e,t){return(Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toFixed(t)}const v=Object(l.withStyles)(y)(e=>{const{value:t,classes:a,fill:l}=e;let{digits:c}=e;const o=(100===l?u.a:r.a)[500];return null==c&&(c=2),b.a.createElement("div",{className:a.root},b.a.createElement("div",{className:a.avatar},b.a.createElement("object",{className:a.img,data:p,type:"image/svg+xml"}),b.a.createElement("span",{style:{height:`calc(${l}% - 5px)`,background:o},className:a.fill})),b.a.createElement(n.v,{variant:"body1",color:"textSecondary",component:"div"},f(t,c),"°"))}),h=Object(l.withStyles)(y)(e=>{const{value:t}=e;return b.a.createElement(o.a,{style:{padding:"25px",background:Object(m.a)(t),fontSize:"1em"}},f(t,1),"°")})},414:function(e,t,a){e.exports=a.p+"icon_black.svg?5136879a03a13f9fb18f241b081f38cb"},5642:function(e,t,a){"use strict";a.r(t);var n=a(48),l=a(95),c=a.n(l),o=a(66),s=a.n(o),r=a(62),i=a.n(r),u=a(63),d=a.n(u),b=a(89),m=a.n(b),p=a(19),y=a(103),f=a.n(y),v=a(104),h=a.n(v),g=a(389),O=a.n(g),j=a(387),E=a.n(j),k=a(400),S=a.n(k),C=a(399),w=a.n(C),x=a(0),P=a.n(x),B=a(28),D=a(5640),T=a(64),N=a(411),z=a(377),F=a(379),$=a(413),M=a(85),R=a(380),I=a(393),G=a(88);const W=P.a.lazy(()=>a.e(16).then(a.bind(null,5637))),H=P.a.lazy(()=>Promise.all([a.e(0),a.e(17)]).then(a.bind(null,5638)));function L(e){return e>9?e.toString():"0"+e}function U(e){return e+1>6?0:e+1}t.default=Object(B.e)(Object(p.withStyles)(e=>({list:{marginTop:0,marginBottom:2*e.spacing.unit},tab:{minWidth:"50px"},avatar:{}}))(e=>{const{classes:t,location:a,history:l}=e,o=Object(G.b)(),[r,u]=P.a.useState(!1),[b,p]=P.a.useState(!1),[y,v]=P.a.useState(0),{plan:g,loaded:j}=Object(I.e)(e.match.params.id),{undo:k,commit:C}=Object(I.a)();P.a.useEffect(()=>{K(0),u(!1),p(!1)},[a,j]);const{isDirty:B,setDirty:A,selectedDay:J,copyDays:Z,loadSetPoint:q,newSetPoint:V,selectDay:Y,removeSetPoint:_}=Object(I.d)(),K=Object(x.useCallback)(e=>{v(e),Y(U(e))},[o]);return P.a.createElement(P.a.Fragment,null,P.a.createElement(W,{open:b,onConfirm:e=>{Z(U(y),e),K(y),p(!1)},onCancel:()=>{p(!1)}}),P.a.createElement(H,{open:r,onClose:e=>{e&&(A(!0),K(y)),u(!1)}}),P.a.createElement(R.a,null,{header:P.a.createElement(z.a,null,{title:Object(M.a)("schedule.title"),button:P.a.createElement(F.b,{first:!0,onClick:function(){k(),l.replace({pathname:`/plans/${g.id}`,state:!0})},icon:B?P.a.createElement(E.a,null):P.a.createElement(O.a,null)}),actions:P.a.createElement(P.a.Fragment,null,P.a.createElement(F.b,{onClick:()=>{p(!0)},icon:P.a.createElement(w.a,null)}),B&&P.a.createElement(n.a,{color:"inherit",onClick:function(){C(),l.replace({pathname:`/plans/${g.id}`,state:!0})}},Object(M.a)("schedule.save"))),subBar:P.a.createElement(h.a,{value:y,onChange:(e,t)=>K(t),variant:"fullWidth"},P.a.createElement(f.a,{classes:{root:e.classes.tab},disableRipple:!0,label:Object(M.a)("schedule.Monday")}),P.a.createElement(f.a,{classes:{root:e.classes.tab},disableRipple:!0,label:Object(M.a)("schedule.Tuesday")}),P.a.createElement(f.a,{classes:{root:e.classes.tab},disableRipple:!0,label:Object(M.a)("schedule.Wednesday")}),P.a.createElement(f.a,{classes:{root:e.classes.tab},disableRipple:!0,label:Object(M.a)("schedule.Thursday")}),P.a.createElement(f.a,{classes:{root:e.classes.tab},disableRipple:!0,label:Object(M.a)("schedule.Friday")}),P.a.createElement(f.a,{classes:{root:e.classes.tab},disableRipple:!0,label:Object(M.a)("schedule.Saturday")}),P.a.createElement(f.a,{classes:{root:e.classes.tab},disableRipple:!0,label:Object(M.a)("schedule.Sunday")}))}),paddingTop:100,paddingBottom:60,body:P.a.createElement(P.a.Fragment,null,P.a.createElement(D.a,{enabled:r||b,isolation:!1},P.a.createElement(i.a,{className:t.list},J.last&&P.a.createElement(P.a.Fragment,{key:"-1"},P.a.createElement(d.a,{button:!0,onClick:()=>K(function(e){return 0===e?6:e-1}(J.last&&J.last.day||0))},P.a.createElement($.b,{value:J.last.targetTemperature}),P.a.createElement(m.a,{primary:`${T.a[J.last.day]}`,secondary:`${L(J.last.hour)}:${L(J.last.minute)}`})),P.a.createElement(c.a,null)),J.schedules.map(e=>P.a.createElement(P.a.Fragment,{key:e.index},P.a.createElement(d.a,{button:!0,onClick:()=>(function(e,t){q(Object.assign({},e,{index:t})),u(!0)})(e,e.index)},P.a.createElement($.b,{value:e.targetTemperature}),P.a.createElement(m.a,{primary:`${L(e.hour)}:${L(e.minute)}`}),P.a.createElement(n.p,null,P.a.createElement(s.a,{className:t.menuButton,onClick:()=>(e=>{_(e),K(y)})(e.index)},P.a.createElement(S.a,null)))),P.a.createElement(c.a,null))))),P.a.createElement(N.a,{onClick:function(){V(U(y)),u(!0)}}))}))}))}}]);
//# sourceMappingURL=https://raw.githubusercontent.com/mskg/homey-heating/release/v1.2.2-rc1/settings/15.js.map